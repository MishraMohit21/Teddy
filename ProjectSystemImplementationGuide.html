<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teddy Engine Project System: A-Z Implementation Guide</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #e0e0e0;
            background-color: #1e1e1e;
            margin: 0;
            padding: 0;
        }
        #container {
            max-width: 1024px;
            margin: 20px auto;
            padding: 20px;
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        h1, h2, h3, h4 {
            color: #4fc3f7;
            border-bottom: 2px solid #4fc3f7;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        h1 { font-size: 2.8em; text-align: center; border-bottom-width: 4px;}
        h2 { font-size: 2.2em; }
        h3 { font-size: 1.7em; color: #81d4fa; border-bottom-style: dashed; }
        h4 { font-size: 1.3em; color: #b3e5fc; border-bottom: 1px solid #81d4fa; }
        code {
            font-family: "Fira Code", "Consolas", "Monaco", monospace;
            background-color: #1e1e1e;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-size: 0.95em;
        }
        pre {
            background-color: #161616;
            border: 1px solid #444;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95em;
        }
        pre code {
            padding: 0;
            background-color: transparent;
            border: none;
        }
        strong, b { color: #ffca28; }
        ul { list-style-type: square; padding-left: 20px; }
        li { margin-bottom: 10px; }
        .note {
            background-color: #2c3e50;
            border-left: 5px solid #4fc3f7;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        .success {
            background-color: #27ae60;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>Teddy Engine Project System: A-Z Implementation Guide</h1>

        <div class="note">
            <p><strong>Document Purpose:</strong> This document provides a complete architectural overview and step-by-step implementation plan for integrating a robust, scalable project system into the Teddy Engine. It is designed to be a comprehensive tutorial.</p>
        </div>

        <h2>Phase 1: Research & Analysis (Completed)</h2>
        <p>We performed a detailed analysis of the existing codebase to identify key areas for modification. We found widespread use of hardcoded paths, confirmed the ImGui version (v1.79 WIP) is suitable for our UI needs, and understood the existing patterns for file dialogs and script loading.</p>

        <hr style="margin: 40px 0; border-color: #444;">

        <h2>Phase 2: System Design & Scalability</h2>
        <p>This section details the architecture of the new project system, with a focus on ensuring it is robust and scalable for future development.</p>

        <h3>2.1. The Core Concept: The Project</h3>
        <p>The central concept is the <strong>Project</strong>. A project is a self-contained unit, represented by a folder on disk. This folder contains a special <code>.teddyproj</code> file and all associated assets and scripts. The engine will no longer open individual scene files; it will open projects.</p>

        <h3>2.2. The <code>.teddyproj</code> Schema</h3>
        <p>This YAML file is the heart of the project. It's a simple, extensible format.</p>
        <pre><code># C:/Path/To/MyProject/MyProject.teddyproj
Project:
  Name: "MyProject"
  StartScene: "Scenes/Main.teddy"      # Path relative to AssetDirectory
  AssetDirectory: "Assets"             # The root folder for all game assets
  ScriptModulePath: "Scripts/MyProject.Scripts.dll" # Path to the compiled C# assembly, relative to project root</code></pre>

        <h3>2.3. Scalability Considerations</h3>
        <p>A "completely scalable" system is one that can grow in complexity and size without requiring major architectural rewrites. Here’s how our design achieves this:</p>
        
        <h4>Project Configuration Scalability</h4>
        <p>The YAML-based <code>.teddyproj</code> schema is inherently scalable. Adding new settings (e.g., physics layers, render pipelines) is as simple as adding a new key-value pair. The <code>ProjectSerializer</code> can be designed to handle missing fields gracefully, ensuring forward and backward compatibility.</p>

        <h4>Asset & Workflow Scalability</h4>
        <p>The project system provides a clean separation between <strong>source assets</strong> (in the `Assets` directory) and <strong>imported/cached assets</strong> (which will live in a `Library` directory). This is a standard, robust pattern that scales to large teams and projects by ensuring that only source files are checked into version control.</p>

        <h3>2.4. New Feature: Project Templating</h3>
        <p>To improve usability, we will add a <strong>Project Templating</strong> system. Instead of starting with a blank slate, users can choose a template to bootstrap their project with a standard folder structure and sample content.</p>
        <h4>Template Location</h4>
        <p>Templates will be stored as independent folders within the editor's own directory structure, for example: <code>TeddEditor/Resources/Templates/</code></p>
        <h4>Default Template Example</h4>
        <p>We will create a `Default 2D` template with the following structure:</p>
        <pre><code>TeddEditor/Resources/Templates/Default 2D/
├── Assets/
│   ├── Scenes/
│   │   └── Main.teddy
│   ├── Scripts/
│   │   └── Player.cs
│   └── Textures/
│       └── DefaultSprite.png
└── Project.teddyproj.template</code></pre>
        <p>When a user creates a new project using this template, the editor will copy this entire structure to the new project location and rename `Project.teddyproj.template` to the actual project file name.</p>

        <div class="success">This design is not just a refactor; it's a foundational architectural improvement that aligns the Teddy Engine with modern, scalable engine design principles.</div>

        <h2>Phase 3: Core Implementation (Step-by-Step)</h2>
        <p>The following sections contain the full code for the initial implementation. I will proceed with these steps once you approve this updated plan.</p>
        
        <h3>Milestone 1: Create Core Project Classes (Completed)</h3>
        <ul>
            <li>Create `Project.h` and `Project.cpp`.</li>
            <li>Create `ProjectSerializer.h` and `ProjectSerializer.cpp`.</li>
            <li>Integrate new files into `premake5.lua` and compile to ensure correctness.</li>
        </ul>

        <h3>Milestone 2: Integrate Project with Application (Completed)</h3>
        <ul>
            <li>Modify `Application.h` to include project management methods (`NewProject`, `OpenProject`, etc.).</li>
            <li>Modify `Application.cpp` to implement these methods and to load a project from command-line arguments.</li>
            <li>Compile and verify changes.</li>
        </ul>

        <h2>Phase 4: Editor and UI Refactoring (Current)</h2>
        <p>Now we will make the editor project-aware.</p>

        <h3>Milestone 3: Refactor Content Browser</h3>
        <ul>
            <li><b>Goal:</b> Make the Content Browser display the contents of the active project's `Assets` directory.</li>
            <li><b>Steps:</b>
                <ol>
                    <li>Modify `ContentBrowser.h` to accept a `Ref<Project>` in its constructor.</li>
                    <li>Modify `ContentBrowser.cpp` to use the project's asset directory as its base path.</li>
                    <li>Update `EditorLayer` to create the `ContentBrowser` instance after a project is loaded.</li>
                </ol>
            </li>
        </ul>

        <h3>Milestone 4: Implement Project Hub and File Menu</h3>
        <ul>
            <li><b>Goal:</b> Create the main UI for project management.</li>
            <li><b>Steps:</b>
                <ol>
                    <li>In `EditorLayer`, implement the `File` menu actions (`New Project`, `Open Project`, `Save Project`).</li>
                    <li>`New Project` will open a dialog asking for a project name, location, and template. It will then call the template-copying logic.</li>
                    <li>`Open Project` will use the `FileDialogs` utility to select a `.teddyproj` file.</li>
                    <li>If no project is active when the editor starts, display a modal "Project Hub" window that forces the user to either create or open a project.</li>
                </ol>
            </li>
        </ul>

        <p class="note">I will now proceed with **Milestone 3: Refactor Content Browser** by modifying the `ContentBrowser.h` and `ContentBrowser.cpp` files as planned.</p>
    </div>
</body>
</html>
